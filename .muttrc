source "gpg -d ~/.config/mutt/credentials.gpg |"
# IMAP config
set imap_user="coldmeadow@hmri.org.au"

set folder="imaps://outlook.office365.com/"
set spoolfile= +INBOX
set record = +INBOX


# Where to put the stuff
set header_cache = "~/.config/mutt/cache/headers"
set message_cachedir = "~/.config/mutt/cache/bodies"
set certificate_file = "~/.config/mutt/certificates"

mailboxes

#set imap_check_subscribed="yes"
#set imap_list_subscribed="yes"
set timeout=15
set mail_check=90
set imap_keepalive=180
set imap_idle
unset mark_old
set ssl_use_sslv3=yes

# SMTP config
set realname = "Chris Oldmeadow"
set from = "christopher.oldmeadow@hmri.org.au"
set hostname = "hmri.org.au"
set smtp_url = "smtp://coldmeadow@hmri.org.au@outlook.office365.com:587/"
set ssl_force_tls = yes
set smtp_authenticators = "login"


# General
set signature="~/.config/mutt/signature"
set editor = "nvim"

set mailcap_path = ~/.config/mutt/mailcap

auto_view text/html
alternative_order text/html text/plain text/enriched

auto_view applica/pdf

set sort=threads
set sort_browser=date
set sort_aux=reverse-last-date-received


## Abook
set query_command= "abook --mutt-query '%s'"
macro index,pager  a "<pipe-message>abook --add-email-quiet<return>" "Add this sender to Abook"
bind editor        <Tab> complete-query

# Addressbook
#set query_command = "~/scripts/ldap_owa_query.sh '$from' '$smtp_pass' '%s'"

# Calendar invites
auto_view text/calendar application/ics
macro index,pager ",m" ":unset wait_key\n |/home/chris/scripts/add_to_calcurse.sh<enter><exit>"

#source ~/.mutt/mutt-colors-solarized/mutt-colors-solarized-dark-16.muttrc
# Colours for items in the index
color index brightcyan black ~N
# Hmm, don't like this.
#color index brightgreen black "~N (~x byers.world)|(~x byers.x)|(~x langly.levallois123.axialys.net)|(~x the.earth.li)"
color index brightyellow black ~F
color index black green ~T
color index brightred black ~D
mono index bold ~N
mono index bold ~F
mono index bold ~T
mono index bold ~D

# Highlights inside the body of a message.

# URLs
color body brightgreen black "(http|ftp|news|telnet|finger)://[^ \"\t\r\n]*"
color body brightgreen black "mailto:[-a-z_0-9.]+@[-a-z_0-9.]+"
mono body bold "(http|ftp|news|telnet|finger)://[^ \"\t\r\n]*"
mono body bold "mailto:[-a-z_0-9.]+@[-a-z_0-9.]+"

# email addresses
color body brightgreen black "[-a-z_0-9.%$]+@[-a-z_0-9.]+\\.[-a-z][-a-z]+"
#mono body bold "[-a-z_0-9.%$]+@[-a-z_0-9.]+\\.[-a-z][-a-z]+"

# header
color header green black "^from:"
color header green black "^to:"
color header green black "^cc:"
color header green black "^date:"
color header yellow black "^newsgroups:"
color header yellow black "^reply-to:"
color header brightcyan black "^subject:"
color header red black "^x-spam-rule:"
color header green black "^x-mailer:"
color header yellow black "^message-id:"
color header yellow black "^Organization:"
color header yellow black "^Organisation:"
color header yellow black "^User-Agent:"
color header yellow black "^message-id: .*pine"
color header yellow black "^X-Fnord:"
color header yellow black "^X-WebTV-Stationery:"
color header yellow black "^X-Message-Flag:"
color header yellow black "^X-Spam-Status:"
color header yellow black "^X-SpamProbe:"
color header red black "^X-SpamProbe: SPAM"


# Coloring quoted text - coloring the first 7 levels:
color quoted cyan black
color quoted1 yellow black
color quoted2 red black
color quoted3 green black
color quoted4 cyan black
color quoted5 yellow black
color quoted6 red black
color quoted7 green black


# Default color definitions
#color hdrdefault white green
color signature brightmagenta black
color indicator black cyan 
color attachment black green
color error red black
color message white black
color search brightwhite magenta
color status brightyellow blue
color tree brightblue black
color normal white black
color tilde green black
color bold brightyellow black
#color underline magenta black
color markers brightcyan black
# Colour definitions when on a mono screen
mono bold bold
mono underline underline
mono indicator reverse



# Keybindings
# some sane vim-like keybindings
bind pager g noop
bind pager G noop
bind index G noop
bind generic,index,pager \Cf       next-page
bind generic,index,pager \Cb       previous-page
bind generic             gg        first-entry
bind generic,index       G         last-entry
bind pager               gg        top
bind pager               G         bottom
bind index,pager k previous-entry
bind index,pager j next-entry
bind index,pager \Cu half-up
bind index,pager \Cd half-down

#bind  index,pager    a   group-reply
#macro index,pager    dd  "<delete-message><sync-mailbox>"
